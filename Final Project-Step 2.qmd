---
title: 'Final Project - Step 2 (15 Points)'
subtitle: "PSTAT100: Data Science Concepts and Analysis" 

author:
    affiliations:
      - name: "Spring 2025"
affiliation-title: "Quarter"
format: 
 pdf: 
    latex_engine: xelatex
    geometry: "letterpaper, margin=0.3in"
    code-fold: true
    code-line-numbers: true
    code-copy: true
    code-tools: true
    self-contained: true
    toc: false
    toc-location: left
    number-sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message =  FALSE)
knitr::opts_chunk$set(warning =  FALSE)
knitr::opts_chunk$set(error =  FALSE)
bfcolor <- function(x, color) {
  if (knitr::is_latex_output()) {
    sprintf("\\textcolor{%s}{\\textbf{%s}}", color, x)
  } else if (knitr::is_html_output()) {
    sprintf("<span style='color: %s;'><b>%s</b></span>", color, x)
  } else x
}
```

:::: callout
::: {style="text-align: center"}
[**STUDENT NAME**]{style="color: blue;"}
:::

-   Valerie De La Fuente (valeriedelafuente)
-   Matthew Arteaga (matthewarteaga)
-   Phuc Lu (pdlu)
-   STUDENT 4 (NetID 4)
-   STUDENT 5 (NetID 5)
::::

::: callout-caution
## Due Date

The deadline for this step is **Friday, May 9, 2025**.
:::

::: callout-tip
# Instructions

In this step, you will develop clear research questions and hypotheses based on your selected dataset, and conduct a thorough Exploratory Data Analysis (EDA). This foundational work is crucial for guiding your analysis in the following steps.
:::

# Step 2: Research Questions, Hypotheses, and Exploratory Data Analysis (EDA)

## Research Questions

**Question 1**

Do certain dietary habits coincide with an increased rate of depression among students?

**Question 2** 

Is there a correlation between the amount of sleep a student gets and the proportion of them that are depressed?

**Question 3**

Does the presence (and magnitude) of certain stressors have an impact on the rate at which students are depressed?

## Hypotheses

**Hypothesis 1**

Students with moderate to healthy dietary habits will have lower rates of depression compared to students with unhealthy dietary habits.

**Hypothesis 2**

Students who average more sleep per night will have lower rates of depression compared to students who average less.

**Hypothesis 3**

Students with the highest collective reported stressors (`Academic Pressure + Work Pressure + Financial Stress`) will have higher rates of depression compared to students with lower collective reported stressors.

## Exploratory Data Analysis (EDA)

## Data Cleaning

### Viewing the Data

```{r, warning = FALSE}
# Load necessary packages
library(readr)
library(tidyverse)
library(naniar)
library(janitor)

# Load in the data
depression_data <- read.csv("data/student_depression_dataset.csv")

# View the dataset
head(depression_data)

# Examine the dimensions
dim(depression_data)
```

There are 27901 observations and 18 variables in this dataset. The list of variables is as follows:

-   `id`: A unique identifier assigned to each student record in the dataset.

-   `Gender`: The gender of the student (e.g., Male, Female, Other). This helps in analyzing gender-specific trends in mental health.

-   `Age`: The age of the student in years.

-   `City`: The city or region where the student resides, providing geographical context for the analysis.

-   `Profession`: The field of work or study of the student, which may offer insights into occupational or academic stress factors.

-   `Academic Pressure`: A measure indicating the level of pressure the student faces in academic settings. This could include stress from exams, assignments, and overall academic expectations.

-   `Work Pressure`: A measure of the pressure related to work or job responsibilities, relevant for students who are employed alongside their studies.

-   `CGPA`: The cumulative grade point average of the student, reflecting overall academic performance.

-   `Study Satisfaction`: An indicator of how satisfied the student is with their studies, which can correlate with mental well-being.

-   `Job Satisfaction`: A measure of the student’s satisfaction with their job or work environment, if applicable.

-   `Sleep Duration`: The average number of hours the student sleeps per day, which is an important factor in mental health.

-   `Dietary Habits`: An assessment of the student’s eating patterns and nutritional habits, potentially impacting overall health and mood.

-   `Degree`: The academic degree or program that the student is pursuing.

-   `Have you ever had suicidal thoughts?`: A binary indicator (Yes/No) that reflects whether the student has ever experienced suicidal ideation.

-   `Work/Study Hours`: The average number of hours per day the student dedicates to work or study, which can influence stress levels.

-   `Financial Stress`: A measure of the stress experienced due to financial concerns, which may affect mental health.

-   `Family History of Mental Illness`: A measure of the stress experienced due to financial concerns, which may affect mental health.

-   `Depression`: The target variable that indicates whether the student is experiencing depression (Yes/No). This is the primary focus of the analysis.

### Fixing Column Names

```{r}
# Fix column names
depression_data <- depression_data %>% 
  clean_names() %>%
  rename(
    cum_gpa = cgpa,
    suicidal_thoughts = have_you_ever_had_suicidal_thoughts,
    fam_mental_illness = family_history_of_mental_illness
  )

# Check if names were fixed
names(depression_data)
```

### Missing Data

```{r}
# View missing data
sum(is.na(depression_data))
```

There is no missing data present.

### Checking Data Types

```{r}
# Check data types of the variables
str(depression_data)
```

According to the output, we must mutate some variables. This includes factorization and fixing some values that the variables take in.

### Mutating Variables

```{r}
# Factorizing the `gender` variable
depression_data$gender <- factor(depression_data$gender)

# Fixing the `city` variable to change invalid entries
depression_data <- depression_data %>%
  mutate(city = case_when(
    city == "Khaziabad" ~ "Ghaziabad",
    city == "Nalyan" ~ "Kalyan",
    city == "'Less Delhi'" ~ "Delhi",
    city == "'Less than 5 Kalyan'" ~ "Kalyan",
    city == "3.0" ~ "Other",
    city == "Saanvi" ~ "Other",
    city == "M.Tech" ~ "Other",
    city == "Bhavna" ~ "Other",
    city == "City" ~ "Other",
    city == "Mira" ~ "Other",
    city == "Harsha" ~ "Other",
    city == "Vaanya" ~ "Other",
    city == "Gaurav" ~ "Other",
    city == "Harsh" ~ "Other",
    city == "Reyansh" ~ "Other",
    city == "Kibara" ~ "Other",
    city == "Rashi" ~ "Other",
    city == "ME" ~ "Other",
    city == "M.Com" ~ "Other",
    city == "Mihir" ~ "Other",
    city == "Nalini" ~ "Other",
    city == "Nandini" ~ "Other",
    TRUE ~ city  # Leave valid entries as they are
  ))

# Fixing the `profession` variable to change invalid entries
depression_data <- depression_data %>% 
  mutate(profession = case_when(
    profession == "'Civil Engineer'" ~ "Civil Engineer",
    profession == "'UX/UI Designer'" ~ "UX/UI Designer",
    profession == "'Digital Marketer'" ~ "Digital Marketer",
    profession == "'Content Writer'" ~ "Content Writer",
    profession == "'Educational Consultant'" ~ "Educational Consultant",
    TRUE ~ profession # Leave valid entries as they are 
  ))

# Fixing the `work_pressure` variable for proper scaling
depression_data <- depression_data %>%
  mutate(work_pressure = case_when(
    work_pressure == 0 ~ 0,
    work_pressure == 2 ~ 1,
    work_pressure == 5 ~ 3
  ))

# Fixing the `sleep_duration` variable to change invalid entries
depression_data <- depression_data %>% 
  mutate(sleep_duration = case_when(
    sleep_duration == "'5-6 hours'" ~ "5-6 hours",
    sleep_duration == "'Less than 5 hours'" ~ "Less than 5 hours",
    sleep_duration == "'7-8 hours'" ~ "7-8 hours",
    sleep_duration == "'More than 8 hours'" ~ "More than 8 hours",
    sleep_duration == "Others" ~ "Other"
  ))

# Factorizing the `sleep_duration` variable
depression_data <- depression_data %>%
  mutate(sleep_duration = factor(sleep_duration, 
                                 levels = c("Less than 5 hours", 
                                            "5-6 hours", 
                                            "7-8 hours", 
                                            "More than 8 hours", 
                                            "Other"),
                                 ordered = TRUE))

# Fixing the `dietary_habits` variable to change misspelling
depression_data <- depression_data %>% 
  mutate(dietary_habits = case_when(
    dietary_habits == "Others" ~ "Other",
    TRUE ~ dietary_habits
  ))

# Factorizing the `dietary_habits` variable
depression_data <- depression_data %>%
  mutate(dietary_habits = factor(dietary_habits,
                                 levels = c("Healthy", "Moderate", "Unhealthy",
                                            "Other"),
                                 ordered = TRUE))

# Fixing the `degree` variable to change invalid entries
depression_data <- depression_data %>%
  mutate(degree = case_when(
    degree == "'Class 12'" ~ "Diploma",   
    degree == "ME" ~ "M.Tech",               
    degree == "BSc" ~ "B.Sc.",
    degree == "BCA" ~ "B.C.A.",
    degree == "High School" ~ "Other",        
    TRUE ~ degree
  ))

# Factorizing the `degree variable`
degree_levels <- c(
  "High School",
  "BA", "B.Sc.", "B.Com", "B.C.A.", "B.Pharm", "B.Ed", "B.Tech", "BE", "BHM", "B.Arch", "BBA",
  "MA", "MSc", "MBA", "M.Com", "MCA", "M.Tech", "M.Ed", "M.Pharm", "MHM",
  "LLB", "LLM", "MD", "MBBS",
  "PhD",
  "Others"
)
depression_data <- depression_data %>%
  mutate(degree = factor(degree, levels = degree_levels, ordered = TRUE))

# Factorizing the `suicidal_thoughts` variable
depression_data$suicidal_thoughts <- factor(depression_data$suicidal_thoughts)

# Fixing the `financial_stress` variable
depression_data$financial_stress <- as.numeric(depression_data$financial_stress)

# Factorizing the `fam_mental_illness` variable
depression_data$fam_mental_illness <- factor(depression_data$fam_mental_illness)

# Turning the `depression` variable back to "yes" and "no" for visualization purposes
depression_data <- depression_data %>% 
  mutate(depression = case_when(
    depression == 0 ~ "No",
    depression == 1 ~ "Yes"
  ))

# Factorizing the `depression` variable
depression_data$depression <- factor(depression_data$depression)

# Check data types of the variables again to ensure everything was properly done
str(depression_data)
```

According to the output, the data was successfully cleaned and the variables are ready for visualization.

## Descriptive Statistics

## Data Visualization
