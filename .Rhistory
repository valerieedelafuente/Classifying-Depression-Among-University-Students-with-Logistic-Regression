runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
View(mtcars)
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
library(bslib)
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
install.packages("shinyBS")
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
library(bslib)
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
bsTooltip("sumStatsCheckbox",
"Click to display the summary function output for the main and optional variables",
placement = "right", trigger = "hover")
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
runApp('C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project/Will-Mini-Project-2')
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)
library(survival)
library(survminer)
library(ggplot2)
GRACE1000 <- read_table("C:/Users/willi/OneDrive/Documents/GitHub/PSTAT175-Final/GRACE1000.dat", col_names = FALSE)
GRACE1000 <- GRACE1000 %>% select(-X10)
colnames(GRACE1000) <- c("id", "days", "death", "revasc", "revascdays", "los", "age", "sysbp", "stchange")
# Forward Stepwise Selection
# Possible covariates are revasc, revascdays, sysbp, age, stchange, los
revdays.mod <- coxph(Surv(days,death) ~ revascdays, data = GRACE1000)
age.mod <- coxph(Surv(days,death) ~ age, data = GRACE1000)
sysbp.mod <- coxph(Surv(days,death) ~ sysbp, data = GRACE1000)
stchange.mod <- coxph(Surv(days,death) ~ stchange, data = GRACE1000)
los.mod <- coxph(Surv(days,death) ~ los, data = GRACE1000)
revasc.mod <- coxph(Surv(days,death) ~ revasc, data = GRACE1000)
AIC(revdays.mod, age.mod, sysbp.mod, stchange.mod, los.mod, revasc.mod)
BIC(revdays.mod, age.mod, sysbp.mod, stchange.mod, los.mod, revasc.mod)
# Lowest AIC (4151.309) and BIC (4155.090) is age
age.revdays.mod <- coxph(Surv(days,death) ~ age + revascdays, data = GRACE1000)
age.sysbp.mod <- coxph(Surv(days,death) ~ age + sysbp, data = GRACE1000)
age.stchange.mod <- coxph(Surv(days,death) ~ age + stchange, data = GRACE1000)
age.los.mod <- coxph(Surv(days,death) ~ age + los, data = GRACE1000)
age.revasc.mod <- coxph(Surv(days,death) ~ age + revasc, data = GRACE1000)
AIC(age.revdays.mod, age.sysbp.mod, age.stchange.mod, age.los.mod, age.revasc.mod)
BIC(age.revdays.mod, age.sysbp.mod, age.stchange.mod, age.los.mod, age.revasc.mod)
# Lowest AIC (4043.699) and BIC (4051.261) is revascdays + age
revdays.age.sysbp.mod <- coxph(Surv(days,death) ~ revascdays + age + sysbp, data = GRACE1000)
revdays.age.stchange.mod <- coxph(Surv(days,death) ~ revascdays + age + stchange, data = GRACE1000)
revdays.age.los.mod <- coxph(Surv(days,death) ~ revascdays + age + los, data = GRACE1000)
revdays.age.revasc.mod <- coxph(Surv(days,death) ~ revascdays + age + revasc, data = GRACE1000)
AIC(revdays.age.sysbp.mod, revdays.age.stchange.mod, revdays.age.los.mod, revdays.age.revasc.mod)
BIC(revdays.age.sysbp.mod, revdays.age.stchange.mod, revdays.age.los.mod, revdays.age.revasc.mod)
# Lowest AIC (3701.919) and BIC (3713.261) is revasc + revascdays + age
revasc.revdays.age.sysbp.mod <- coxph(Surv(days,death) ~ revasc + revascdays + age + sysbp, data = GRACE1000)
revasc.revdays.age.stchange.mod <- coxph(Surv(days,death) ~ revasc + revascdays + age + stchange, data = GRACE1000)
revasc.revdays.age.los.mod <- coxph(Surv(days,death) ~ revasc + revascdays + age + los, data = GRACE1000)
AIC(revasc.revdays.age.sysbp.mod, revasc.revdays.age.stchange.mod, revasc.revdays.age.los.mod)
BIC(revasc.revdays.age.sysbp.mod, revasc.revdays.age.stchange.mod, revasc.revdays.age.los.mod)
# Lowest AIC (3697.444) and BIC (3712.567) is sysbp + revasc + revascdays + age
# very close to los with AIC of 3697.495 and BIC of 3712.618
sysbp.revasc.revdays.age.stchange.mod <- coxph(Surv(days,death) ~ sysbp + revasc + revascdays + age + stchange, data = GRACE1000)
sysbp.revasc.revdays.age.los.mod <- coxph(Surv(days,death) ~ sysbp + revasc + revascdays + age + los, data = GRACE1000)
AIC(sysbp.revasc.revdays.age.stchange.mod, sysbp.revasc.revdays.age.los.mod)
BIC(sysbp.revasc.revdays.age.stchange.mod, sysbp.revasc.revdays.age.los.mod)
# Lowest AIC (3696.180) and BIC (3711.925) is los + sysbp + revasc + revascdays + age
# See if stchange lowers AIC and BIC
all.mod <- coxph(Surv(days,death) ~ stchange + sysbp + los + revasc + revascdays + age, data = GRACE1000)
AIC(all.mod) # 3691.309 lowers
BIC(all.mod) # 3713.994 raises, stchange not needed by BIC criterion
# According to forward stepwise selection by AIC, the full model is the best model
# According to BIC, the model with all covariates except stchange is the best model
# Maybe go with BIC to not have all covariates?
ggsurvplot(survfit(Surv(days,death) ~ revasc, data = GRACE1000),
fun = "cloglog") +
labs(x = "log(Days)", y = "Complementary Log-Log",
title = "Log-Log Plot by Revasc")
# Seems very proportional, no assumptions violated
ggsurvplot(survfit(Surv(days,death) ~ stchange, data = GRACE1000),
fun = "cloglog") +
labs(x = "log(Days)", y = "Complementary Log-Log",
title = "Log-Log Plot by Stchange")
# also very parallel lines, no assumptions violated
cox.zph(sysbp.mod)
plot(cox.zph(sysbp.mod))
# The zph test gives a significant p-value which means sysbp violates
# proportional hazards assumption
cox.zph(los.mod)
plot(cox.zph(los.mod))
cox.zph(age.mod)
plot(cox.zph(age.mod))
cox.zph(revdays.mod)
plot(cox.zph(revdays.mod))
summary(revasc.mod)
revasc.mod$var
# Hazard ratio is exp(coef) = 0.4892
# means almost 50% less likely to die with revasc?
exp(coef(revasc.mod) + c(-1.96,1.96) * sqrt(revasc.mod$var[1,1]))
summary(stchange.mod)
revasc.strata.mod <- coxph(Surv(days,death) ~ strata(stchange) * revasc, data = GRACE1000)
summary(revasc.strata.mod)
revasc.strata.mod <- coxph(Surv(days,death) ~ strata(stchange) + revasc, data = GRACE1000)
summary(revasc.strata.mod)
# Hazard ratio = 1.6802
# means almost 70% mroe likelt to die with stchange?
exp(coef(stchange.mod) + c(-1.96,1.96) * sqrt(stchange.mod$var[1,1]))
# Revasc:
summary(revasc.mod)
# Hazard ratio is exp(coef) = 0.4892
# means almost 50% less likely to die with revasc?
exp(coef(revasc.mod) + c(-1.96,1.96) * sqrt(revasc.mod$var[1,1]))
# 95% confidence interval is [0.3909648, 0.6122096]
ggsurvplot(survfit(Surv(days,death) ~ 1, data = GRACE1000))
ggsurvplot(survfit(Surv(days,death) ~ revasc, data = GRACE1000))
# Load in the data
depression_data <- read.csv("/data/student_depression_dataset.csv")
install.packages(c("bayesplot", "bit", "bit64", "broom", "bslib", "classInt", "cli", "clock", "cpp11", "curl", "data.table", "DescTools", "dials", "doBy", "doFuture", "evaluate", "faraway", "fontawesome", "foreign", "fs", "future", "future.apply", "gclus", "generics", "ggplot2", "gld", "glmnet", "globals", "gower", "GPfit", "gtable", "hardhat", "haven", "httpuv", "igraph", "infer", "ISOcodes", "janitor", "jsonlite", "kknn", "KMsurv", "knitr", "labelled", "later", "lava", "lme4", "lubridate", "maps", "MASS", "MatrixModels", "maxstat", "mime", "miniUI", "mvtnorm", "nlme", "nloptr", "openssl", "parallelly", "parsnip", "pbkrtest", "pillar", "pkgbuild", "prodlim", "progressr", "proj4", "promises", "ps", "purrr", "quantreg", "questionr", "QuickJSR", "R.cache", "R.oo", "R.utils", "ragg", "Rcpp", "RcppArmadillo", "RcppTOML", "readxl", "recipes", "reticulate", "rlang", "rmarkdown", "rsample", "rstan", "rstudioapi", "sass", "scales", "seriation", "shiny", "slider", "stringi", "survival", "svglite", "systemfonts", "textrecipes", "textshaping", "tidymodels", "tinytex", "TSP", "tune", "tzdb", "utf8", "vegan", "workflows", "workflowsets", "xfun", "xgboost", "xml2", "yardstick"))
# Load necessary packages
library(readr)
library(tidyverse)
library(naniar)
library(janitor)
#setwd("/Documents/PSTAT 100/finalproject/PSTAT-100-Project/")
# Load in the data
depression_data <- read.csv("/data/student_depression_dataset.csv")
# Load in the data
depression_data <- read.csv("data/student_depression_dataset.csv")
# Load in the data
depression_data <- read.csv("data/student_depression_dataset.csv")
#setwd("/Documents/PSTAT 100/finalproject/PSTAT-100-Project/")
getwd()
setwd("C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project")
#setwd("/Documents/PSTAT 100/finalproject/PSTAT-100-Project/")
getwd()
setwd("C:/Users/willi/OneDrive/Documents/GitHub/PSTAT-100-Project")
# Load in the data
depression_data <- read.csv("data/student_depression_dataset.csv")
#setwd("/Documents/PSTAT 100/finalproject/PSTAT-100-Project/")
getwd()
# Load in the data
depression_data <- read.csv("student_depression_dataset.csv")
# Load in the data
depression_data <- read.csv("student_depression_dataset.csv")
# Fix column names
depression_data <- depression_data %>%
clean_names() %>%
rename(
cum_gpa = cgpa,
suicidal_thoughts = have_you_ever_had_suicidal_thoughts,
fam_mental_illness = family_history_of_mental_illness
)
# Fixing the `financial_stress` variable
depression_data <- depression_data %>%
mutate(
financial_stress = as.numeric(financial_stress),
# convert string numbers to integers
financial_stress = case_when(
financial_stress == "?" ~ NA,
# convert "?" to NA values
.default = financial_stress))
# Remove 3 rows with NA values
depression_data <- depression_data %>% na.omit()
# Factorizing the `gender` variable
depression_data$gender <- factor(depression_data$gender)
# Fixing the `city` variable to change invalid entries
depression_data <- depression_data %>%
mutate(city = case_when(
city == "Khaziabad" ~ "Ghaziabad",
city == "Nalyan" ~ "Kalyan",
city == "'Less Delhi'" ~ "Delhi",
city == "'Less than 5 Kalyan'" ~ "Kalyan",
city == "3.0" ~ "Other",
city == "Saanvi" ~ "Other",
city == "M.Tech" ~ "Other",
city == "Bhavna" ~ "Other",
city == "City" ~ "Other",
city == "Mira" ~ "Other",
city == "Harsha" ~ "Other",
city == "Vaanya" ~ "Other",
city == "Gaurav" ~ "Other",
city == "Harsh" ~ "Other",
city == "Reyansh" ~ "Other",
city == "Kibara" ~ "Other",
city == "Rashi" ~ "Other",
city == "ME" ~ "Other",
city == "M.Com" ~ "Other",
city == "Mihir" ~ "Other",
city == "Nalini" ~ "Other",
city == "Nandini" ~ "Other",
TRUE ~ city  # Leave valid entries as they are
))
# # Fixing the `profession` variable to change invalid entries
depression_data <- depression_data %>%
mutate(profession = case_when(
profession == "'Civil Engineer'" ~ "Civil Engineer",
profession == "'UX/UI Designer'" ~ "UX/UI Designer",
profession == "'Digital Marketer'" ~ "Digital Marketer",
profession == "'Content Writer'" ~ "Content Writer",
profession == "'Educational Consultant'" ~ "Educational Consultant",
TRUE ~ profession # Leave valid entries as they are
))
# Fixing the `work_pressure` variable for proper scaling
depression_data <- depression_data %>%
mutate(work_pressure = case_when(
work_pressure == 0 ~ 0,
work_pressure == 2 ~ 1,
work_pressure == 5 ~ 3
))
# Fixing the `sleep_duration` variable to change invalid entries
depression_data <- depression_data %>%
mutate(sleep_duration = case_when(
sleep_duration == "'5-6 hours'" ~ "5-6 hours",
sleep_duration == "'Less than 5 hours'" ~ "Less than 5 hours",
sleep_duration == "'7-8 hours'" ~ "7-8 hours",
sleep_duration == "'More than 8 hours'" ~ "More than 8 hours",
sleep_duration == "Others" ~ "Other"
))
# Factorizing the `sleep_duration` variable
depression_data <- depression_data %>%
mutate(sleep_duration = factor(sleep_duration,
levels = c("Less than 5 hours",
"5-6 hours",
"7-8 hours",
"More than 8 hours",
"Other"),
ordered = TRUE))
# Fixing the `dietary_habits` variable to change misspelling
depression_data <- depression_data %>%
mutate(dietary_habits = case_when(
dietary_habits == "Others" ~ "Other",
TRUE ~ dietary_habits
))
# Factorizing the `dietary_habits` variable
depression_data <- depression_data %>%
mutate(dietary_habits = factor(dietary_habits,
levels = c("Healthy", "Moderate", "Unhealthy",
"Other"),
ordered = TRUE))
# Fixing the `degree` variable to change invalid entries
depression_data <- depression_data %>%
mutate(degree = case_when(
degree == "'Class 12'" ~ "High School",
degree == "Others" ~ "Other",
# Others could less than HS education or totally unknown.
.default = degree
))
# Factorizing the `degree variable`
degree_levels <- c(
"High School",
"BA", "BSc", "B.Com", "BCA", "B.Pharm", "B.Ed", "B.Tech", "BE", "BHM", "B.Arch", "BBA",
"MA", "MSc", "MBA", "M.Com", "MCA", "M.Tech", "M.Ed", "M.Pharm", "MHM",
"LLB", "LLM", "MD", "MBBS",
"PhD",
"Other"
)
depression_data <- depression_data %>%
mutate(degree = factor(degree, levels = degree_levels, ordered = TRUE))
# Factorizing the `suicidal_thoughts` variable
depression_data$suicidal_thoughts <- factor(depression_data$suicidal_thoughts)
# Factorizing the `fam_mental_illness` variable
depression_data$fam_mental_illness <- factor(depression_data$fam_mental_illness)
# Turning the `depression` variable back to "yes" and "no" for visualization purposes
depression_data <- depression_data %>%
mutate(depression = case_when(
depression == 0 ~ "No",
depression == 1 ~ "Yes"
))
# Factorizing the `depression` variable
depression_data$depression <- factor(depression_data$depression)
# Load necessary packages
library(readr)
library(tidyverse)
library(naniar)
library(janitor)
#setwd("/Documents/PSTAT 100/finalproject/PSTAT-100-Project/")
# Load in the data
depression_data <- read.csv("student_depression_dataset.csv")
# Fix column names
depression_data <- depression_data %>%
clean_names() %>%
rename(
cum_gpa = cgpa,
suicidal_thoughts = have_you_ever_had_suicidal_thoughts,
fam_mental_illness = family_history_of_mental_illness
)
# Fixing the `financial_stress` variable
depression_data <- depression_data %>%
mutate(
financial_stress = as.numeric(financial_stress),
# convert string numbers to integers
financial_stress = case_when(
financial_stress == "?" ~ NA,
# convert "?" to NA values
.default = financial_stress))
# Remove 3 rows with NA values
depression_data <- depression_data %>% na.omit()
# Factorizing the `gender` variable
depression_data$gender <- factor(depression_data$gender)
# Fixing the `city` variable to change invalid entries
depression_data <- depression_data %>%
mutate(city = case_when(
city == "Khaziabad" ~ "Ghaziabad",
city == "Nalyan" ~ "Kalyan",
city == "'Less Delhi'" ~ "Delhi",
city == "'Less than 5 Kalyan'" ~ "Kalyan",
city == "3.0" ~ "Other",
city == "Saanvi" ~ "Other",
city == "M.Tech" ~ "Other",
city == "Bhavna" ~ "Other",
city == "City" ~ "Other",
city == "Mira" ~ "Other",
city == "Harsha" ~ "Other",
city == "Vaanya" ~ "Other",
city == "Gaurav" ~ "Other",
city == "Harsh" ~ "Other",
city == "Reyansh" ~ "Other",
city == "Kibara" ~ "Other",
city == "Rashi" ~ "Other",
city == "ME" ~ "Other",
city == "M.Com" ~ "Other",
city == "Mihir" ~ "Other",
city == "Nalini" ~ "Other",
city == "Nandini" ~ "Other",
TRUE ~ city  # Leave valid entries as they are
))
# # Fixing the `profession` variable to change invalid entries
depression_data <- depression_data %>%
mutate(profession = case_when(
profession == "'Civil Engineer'" ~ "Civil Engineer",
profession == "'UX/UI Designer'" ~ "UX/UI Designer",
profession == "'Digital Marketer'" ~ "Digital Marketer",
profession == "'Content Writer'" ~ "Content Writer",
profession == "'Educational Consultant'" ~ "Educational Consultant",
TRUE ~ profession # Leave valid entries as they are
))
# Fixing the `work_pressure` variable for proper scaling
depression_data <- depression_data %>%
mutate(work_pressure = case_when(
work_pressure == 0 ~ 0,
work_pressure == 2 ~ 1,
work_pressure == 5 ~ 3
))
# Fixing the `sleep_duration` variable to change invalid entries
depression_data <- depression_data %>%
mutate(sleep_duration = case_when(
sleep_duration == "'5-6 hours'" ~ "5-6 hours",
sleep_duration == "'Less than 5 hours'" ~ "Less than 5 hours",
sleep_duration == "'7-8 hours'" ~ "7-8 hours",
sleep_duration == "'More than 8 hours'" ~ "More than 8 hours",
sleep_duration == "Others" ~ "Other"
))
# Factorizing the `sleep_duration` variable
depression_data <- depression_data %>%
mutate(sleep_duration = factor(sleep_duration,
levels = c("Less than 5 hours",
"5-6 hours",
"7-8 hours",
"More than 8 hours",
"Other"),
ordered = TRUE))
# Fixing the `dietary_habits` variable to change misspelling
depression_data <- depression_data %>%
mutate(dietary_habits = case_when(
dietary_habits == "Others" ~ "Other",
TRUE ~ dietary_habits
))
# Factorizing the `dietary_habits` variable
depression_data <- depression_data %>%
mutate(dietary_habits = factor(dietary_habits,
levels = c("Healthy", "Moderate", "Unhealthy",
"Other"),
ordered = TRUE))
# Fixing the `degree` variable to change invalid entries
depression_data <- depression_data %>%
mutate(degree = case_when(
degree == "'Class 12'" ~ "High School",
degree == "Others" ~ "Other",
# Others could less than HS education or totally unknown.
.default = degree
))
# Factorizing the `degree variable`
degree_levels <- c(
"High School",
"BA", "BSc", "B.Com", "BCA", "B.Pharm", "B.Ed", "B.Tech", "BE", "BHM", "B.Arch", "BBA",
"MA", "MSc", "MBA", "M.Com", "MCA", "M.Tech", "M.Ed", "M.Pharm", "MHM",
"LLB", "LLM", "MD", "MBBS",
"PhD",
"Other"
)
depression_data <- depression_data %>%
mutate(degree = factor(degree, levels = degree_levels, ordered = TRUE))
# Factorizing the `suicidal_thoughts` variable
depression_data$suicidal_thoughts <- factor(depression_data$suicidal_thoughts)
# Factorizing the `fam_mental_illness` variable
depression_data$fam_mental_illness <- factor(depression_data$fam_mental_illness)
# Turning the `depression` variable back to "yes" and "no" for visualization purposes
depression_data <- depression_data %>%
mutate(depression = case_when(
depression == 0 ~ "No",
depression == 1 ~ "Yes"
))
# Factorizing the `depression` variable
depression_data$depression <- factor(depression_data$depression)
View(depression_data)
dietHabitsModel <- glm(depression ~ dietary_habits, data = depression_data,
family = 'binomial')
summary(dietHabitsModel)
summary(dietHabitsModel)
dietHabitsModel <- glm(depression ~ dietary_habits - 1, data = depression_data,
family = 'binomial')
summary(dietHabitsModel)
dietHabitsModel <- glm(depression ~ dietary_habits, data = depression_data,
family = 'binomial')
summary(dietHabitsModel)
dietHabitsModel <- glm(depression ~ dietary_habits - 1, data = depression_data,
family = 'binomial')
summary(dietHabitsModel)
kable(summary(dietHabitsModel))
library(kableExtra)
library(knitr)
library(knitr)
library(kableExtra)
kable(summary(dietHabitsModel))
logModelSum <- summary(dietHabitsModel)
kable(logModelSum$coefficients)
logModelSum
kable(logModelSum$coefficients)
logModelSum$coefficients
kable(logModelSum$coefficients)
install.packages("knitr")
install.packages("knitr")
install.packages("rmarkdown")
install.packages("rmarkdown")
library(knitr)
library(rmarkdown)
install.packages(c("cli", "rlang", "xfun"))
