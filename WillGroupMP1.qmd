---
title: 'Mini Project 1'
subtitle: "PSTAT100: Data Science Concepts and Analysis" 

author: "Instructor: Ali Abuzaid"
format: 
 pdf:
    latex_engine: xelatex
    geometry: "letterpaper, margin=0.3in"
    code-fold: true
    code-line-numbers: true
    code-copy: true
    code-tools: true
    self-contained: true
    toc: false
    toc-location: left
    number-sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message =  FALSE)
knitr::opts_chunk$set(warning =  FALSE)
knitr::opts_chunk$set(error =  FALSE)
bfcolor <- function(x, color) {
  if (knitr::is_latex_output()) {
    sprintf("\\textcolor{%s}{\\textbf{%s}}", color, x)
  } else if (knitr::is_html_output()) {
    sprintf("<span style='color: %s;'><b>%s</b></span>", color, x)
  } else x
}
```

::: callout
**STUDENT NAME**

-   William Nelson (williamnelson)
-   Matthew Arteaga (matthewarteaga)
-   STUDENT 3 (NetID 3)
:::

::: callout-tip
# Instructions

-   This mini project aims to familiarize you with real-life data sourced from various resources.

-   The mini project includes narrative questions. While these questions are primarily based on lecture material and prerequisites, they may also require independent thinking and investigation.

-   Collaborate in groups of **2-3** students from the **same section**; individual submissions **will not be accepted**.

-   Please use the provided `MP 1.qmd` file to type your solutions and submit the completed assignment as a PDF file. You can utilize `RStudio`for this purpose. For guidance, refer to the [Tutorial: Hello, Quarto](https://quarto.org/docs/get-started/hello/rstudio.html)).

-   Submit your answers via **Gradescope**.

-   Ensure that all `R` code, mathematical formulas, and workings are presented clearly and appropriately.

-   All figures should be numbered, and axes must be labeled.
:::

::: callout-caution
# Due Date

**Due Date:** Sunday, May 4, 2025, 11:59 PM
:::

\newpage

::: callout-tip
# Survey (Use the attached 'Survey.xlsx' file)

The data was collected during the first lecture from 85 students in the PSTAT 100 class in Spring 2025. The survey has 6 main sections namely Personal Information, Physical Measurements, Health Habits, Diet and Nutrition, Mental Health and Stress, and Academic Life.

These sections are interconnected - for example, physical measurements may relate to health habits and diet, while academic life may impact mental health and sleep patterns.The goal is to explore the relevant variables that may affect students' performance.
:::

```{r}
library(readxl)
library(ggplot2)
library(tidyverse)
Survey <- read_excel("~/RStudio/PSTAT 100/Survey.xlsx")
```

::: callout-important
# **Question 1**

Based on your understanding of the collected data, propose three questions or hypotheses that can be explored or tested using the data.
:::

`r bfcolor("ANSWERS TO QUESTION 1:", "red")`\

***Replace this line with your answers***\

\newpage

::: callout-important
# **Question 2**

Load the data into `R`, obtain basic descriptive statistics for the numerical variables, and provide your interpretation of the results.
:::

`r bfcolor("ANSWERS TO QUESTION 2:", "red")`\

***Replace this line with your answers***\

\newpage

::: callout-important
# **Question 3**

a- Identify any missing values in the `Survey` dataset.

b- Assess the missing data mechanism in the dataset.

c- How would you handle the identified missing values? Save the treated dataset as `SurveyMissing`?

d- Can you address any potential bias for this missing values?
:::

`r bfcolor("ANSWERS TO QUESTION 3:", "red")`\

***Replace this line with your answers***\

\newpage

::: callout-important
# **Question 4**

a- Detect and handle outliers in the `Weight` variable of the dataset.

i- Justify your outlier detection method (e.g., IQR, Z-score, or visual inspection) and explain your chosen handling strategy (e.g., winsorization, capping, or removal).

ii -Discuss the potential impact of these outliers on the analysis if left unaddressed.
:::

```{r}
summary(Survey$Weight)

Survey %>% ggplot(aes(y=Weight)) + 
  geom_boxplot() + labs(y="Weight", title = "Boxplot IQR of Weight")

Survey %>% ggplot(aes(x=Weight)) + 
  geom_histogram(bins = 50) + labs(x="Weight", title = "Histogram of Weight")

boxplot.stats(x=Survey$Weight)$out
```

I chose these two visualizations to detect outliers because the boxplot automatically visualizes outliers and the histogram gives a good visualization of the density of the distribution of Weight. The histogram and boxplot both tell us visually that the distribution of weight is centered around about 160 pounds with heavy tails that go out to about 105 pounds and 250 pounds. We also clearly see two outliers thanks to the boxplot highlighting those values as points outside the boxplot whiskers. One outlier is quite close to the end of the whisker, so it is just over 1.5 times the IQR away from the mean, which qualifies it as an outlier. The farther outlier is very obviously an outlier, so we check the outlier values using the "boxplot.stats()" function which returns the outlier values in the "out" column. The outliers are 250 and 390.

To decide how to deal with the outliers, I looked directly at the observations with these weight outliers:

```{r}
Survey %>% filter(Weight >= 250)
```

We can see from the rest of the values in these 2 rows that the weights make sense for their observations. I would confidently infer that the observation with 390 pounds weight was entered as a joke because every other response was similarly extreme to likely be funny.

With the other outlier of 250 pound weight, while it qualifies as an outlier due to its distance from the mean, it is a completely valid value because the observation is a 6 foot 4 inch tall male who exercises nearly every day. This weight should not be removed or changed, but the 390 pound value should be dealt with.

I believe it is completely acceptable to remove this entire observation due to it most likely not being true, but another option would be to cap this outlier to the highest value either at the end of the boxplot whiskers or a value of our choosing. I will choose to cap this value to the highest realistic response we observed, which is 250 pounds. This will reduce the bias that the outlier has on the mean while keeping the relatively large value in case the outlier was a true value. By capping the outlier, we minimize the bias if it is fake data, as well as retaining the response if it is actually real.

```{r}
Survey[Survey == 390] <- 250

Survey %>% filter(Weight >= 250)
```

If we were to leave the outlier value of 390 in the dataset, our mean weight would be biased towards a higher value than the true mean because of how extreme it was compared to the rest of the data. This effect would not be too great though, and we could even keep the value if it appeared to be a person's true weight. Overall, I believe it is beneficial to either remove or cap the outlier.

\newpage

::: callout-important
# **Question 5**

Investigate the relationship between sleep duration (`Sleep`) and perceived stress levels (`Stress`). Address the following:

a- Calculate the average stress level for each sleep duration category and comment.

b- Do certain sleep ranges (e.g., "4–6 hours") correlate with higher/lower stress?

c- Use a boxplot to compare stress distributions across sleep categories and comment!
:::

```{r}
library(readxl)
library(dplyr)
library(ggplot2)
#Survey <- read_excel("Survey.xlsx")
```

## a.)

```{r}
avg_stress <- Survey %>%
  group_by(Sleep) %>%
  summarize(avg = mean(Stress))
avg_stress
```

It appears that the average stress level increases among students the less sleep that they get.

## b.)

The `More than 8 hours` sleep range correlates with the lowest level of stress (`r avg_stress[4,2]`). The `Less than 4 hours` sleep range correlates with the highest level of stress (`r avg_stress[3,2]`).

## c.)

```{r}
Survey$Sleep <- factor(Survey$Sleep, levels = c("Less than 4 hours", "4–6 hours", "6–8 hours",
                                                "More than 8 hours"))
ggplot(data=Survey,mapping=aes(y=Stress,x=Sleep)) +
  geom_boxplot()
```

Based on the boxplot, it appears that a majority of students either fall into the `6-8 hours` or `More than 8 hours` sleep range; those ranges also have the greatest variability in terms of stress levels. Based on the intervals, it appears that there is a negative correlation between the amount of sleep and the stress level that the student reports.

\newpage

::: callout-important
# **Question 6**

Create a visualization to show the distribution of Weight, comment!
:::

```{r}
hist(Survey$Weight,breaks=80,
     main="Weight Distribution")
```

Based on the Histogram of `Weight`, it appears to be relatively normally distributed, with the mean weight being around 160 pounds, with an outlier of 390 pounds.

\newpage

::: callout-important
# **Question 7**

a.  Define a new variable BMI = $\left(\frac{\text{Weight (lb)}}{\text{Height (in)}^2} \right) \times 703$, and classify students into BMI categories based on Centers for Disease Control and Prevention (CDC) guidelines:

-   BMI \< 18.5 → `"Underweight"`\
-   18.5 ≤ BMI \< 25 → `"Normal"`\
-   25 ≤ BMI \< 30 → `"Overweight"`\
-   BMI ≥ 30 → `"Obese"`

b- Visualize and describe the distribution of students' BMI categories using a bar chart.

c- Explore the correlations between **BMI**, **GPA**, and **Stress**. Use visualizations and correlation statistics to summarize the relationships.
:::

Before completing this question, I wanted to highlight that the responses for "Height" are all over the place because some participants entered their height in inches while others typed their actual height like "511" for 5 foot 11 inches as an example. There are many things wrong with the Height responses, but we will use them as is.

```{r}
Survey <- Survey %>% mutate(BMInum = ((Weight/(Heigh**2)) * 703))

Survey <- Survey %>% mutate(
  BMIcat = case_when(
    BMInum < 18.5 ~ "Underweight",
    (BMInum >= 18.5 & BMInum < 25) ~ "Normal",
    (BMInum >= 25 & BMInum < 30) ~ "Overweight",
    BMInum >= 30 ~ "Obese"
    )
  )

Survey %>% select(Weight,Heigh,BMInum,BMIcat) %>% head()
```

```{r}
Survey %>% ggplot(aes(x=BMIcat)) + 
  geom_bar() + labs(x="BMI Category", y="Frequency", title="Bar Graph of BMI Categories")
```

We see that there is a greater frequency of "Obese" BMIs than any other category, but this is due to the large number of participants who entered their height in feet instead of inches, so the BMI calculation is incorrect for those observations.

```{r}
library(corrplot)

surveyCor <- Survey %>% select(BMInum,GPA,Stress) %>% na.omit() %>% cor()
surveyCor

corrplot(surveyCor, type = "lower",diag = FALSE)
```

\
We use the "cor()" function on just the columns we want to obtain the correlation statistics for each pairwise row. We can easily see from the correlation plot that GPA is slightly negatively correlated to BMI and Stress, while Stress has just barely below 0 correlation with BMI. Overall we can conclude that there does not appear to be any significant correlation between BMI, GPA, and Stress.
